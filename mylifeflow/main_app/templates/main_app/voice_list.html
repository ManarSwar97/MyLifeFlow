{% extends 'base.html' %}
{% load static %}

{% block content %}
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<div class="max-w-5xl mx-auto p-8 mt-8 bg-white rounded-2xl shadow-lg">

  <h1 class="text-3xl font-semibold text-[#28304a] text-center mb-8 flex items-center justify-center gap-2">
    <span class="material-icons">graphic_eq</span> Voice Notes
  </h1>

  <div class="max-w-md mx-auto mb-8">
    <form method="GET" action="{% url 'voice_list_search' %}" class="flex items-center gap-2">
      <input
        type="text"
        name="q"
        placeholder="Search Voice by title..."
        value="{{ query }}"
        class="flex-grow border border-blue-700 rounded-lg px-4 py-2 text-base outline-none focus:ring-2 focus:ring-blue-500"
      >
      <button
        type="submit"
        class="bg-blue-700 hover:bg-blue-800 text-white rounded-lg px-5 py-2 transition"
        aria-label="Search"
      >
        <i class="material-icons">search</i>
      </button>
    </form>
  </div>

  <table class="w-full text-[#28304a] border-collapse">
    <thead>
      <tr class="border-b border-[#1e2746]">
        <th class="text-left py-4 px-3 font-semibold bg-white flex items-center gap-1">
          <span class="material-icons align-middle">edit_note</span> Title
        </th>
        <th class="text-left py-4 px-3 font-semibold bg-white flex items-center gap-1">
          <span class="material-icons align-middle">calendar_today</span> Created At
        </th>
        <th class="text-left py-4 px-3 font-semibold bg-white flex items-center gap-1">
          <span class="material-icons align-middle">sentiment_satisfied</span> Emotion
        </th>
        <th class="text-left py-4 px-3 font-semibold bg-white flex items-center gap-1">
          <span class="material-icons align-middle">volume_up</span> Audio
        </th>
        <th class="text-left py-4 px-3 font-semibold bg-white flex items-center gap-1">
          <span class="material-icons align-middle">settings</span> Actions
        </th>
      </tr>
    </thead>
    <tbody>
      {% for voice in voice_list %}
        <tr class="hover:bg-sky-100 border-b border-[#1e2746]">
          <td class="py-4 px-3">{{ voice.title }}</td>
          <td class="py-4 px-3">{{ voice.created_at|date:"Y-m-d" }}</td>
          <td class="py-4 px-3">{{ voice.get_emotion_display }}</td>
          <td class="py-4 px-3">
            {% if voice.audio %}
              <audio controls class="w-64">
                <source src="{{ voice.audio.url }}" type="audio/mpeg">
                Your browser does not support the audio element.
              </audio>
            {% else %}
              <span class="text-gray-400 italic">No audio</span>
            {% endif %}
          </td>
          <td class="py-4 px-3 flex justify-between items-center gap-4">
            <a href="{% url 'voice_detail' voice.id %}" class="bg-teal-600 hover:bg-teal-700 text-white rounded px-3 py-1 text-sm select-none">
              View Details
            </a>
            <div class="flex gap-3">
              <a href="{% url 'voice_update' voice.id %}" class="text-orange-600 hover:text-blue-500" title="Edit">
                <span class="material-icons cursor-pointer transition-colors">edit</span>
              </a>
              <a href="{% url 'voice_delete' voice.id %}" class="text-red-600 hover:text-blue-500" title="Delete">
                <span class="material-icons cursor-pointer transition-colors">delete</span>
              </a>
            </div>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="5" class="text-center py-6 text-gray-500 italic">No voice notes found.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <div class="text-center mt-6">
    <a href="{% url 'voice_create' %}" class="inline-block bg-blue-700 hover:bg-blue-800 text-white rounded-lg px-6 py-3 select-none transition">
      Add Voice Note
    </a>
  </div>
</div>

{% endblock %}
