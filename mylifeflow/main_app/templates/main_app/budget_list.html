{% extends 'base.html' %} 
{% load static %}

{% block content %}
<style>
  
.search-bar-container {
    max-width: 500px;
    margin: 2em auto 1em;
    text-align: center;
  }

  .search-form {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5em;
  }

  .search-form input[type="text"] {
    padding: 0.6em 1em;
    width: 100%;
    max-width: 350px;
    border: 1px solid #1976d2;
    border-radius: 6px;
    outline: none;
    font-size: 1em;
  }

  .search-form button {
    background: #1976d2;
    color: white;
    border: none;
    padding: 0.6em 1.2em;
    border-radius: 6px;
    font-size: 1em;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  .search-form button:hover {
    background: #115293;
  }

</style>
<h1 class="center">Budgets</h1>

    <div class="search-bar-container">
    <form method="GET" action="{% url 'budget_list_search' %}" class="search-form">
      <input type="text" name="q" placeholder="Search Budget by name..." value="{{ query }}">
      <button type="submit"><i class="fas fa-search"></i></button>
    </form>
  </div>

<a href="{% url 'budget_create' %}" class="btn btn-primary" style="margin-bottom: 20px;">
    Add Budget
</a>

<div class="budget-cards" style="display: flex; flex-wrap: wrap; gap: 1rem">
  {% for budget in budget_list %}
  <div
    class="card"
    style="
      width: 300px;
      padding: 1rem;
      border-radius: 10px;
      background-color: #f9f9f9;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    "
  >
    <h3 style="color: #00796b">{{ budget.name }}</h3>

    <p><strong>Total Budget:</strong> BHD{{ budget.total_amount }}</p>
    <p><strong>Saving Goal:</strong> BHD{{ budget.saving_goal }}</p>
    <p>
      <strong>Planned Expenses:</strong> BHD{{ budget.total_planned_expenses }}
    </p>
    <p><strong>Daily Limit:</strong> BHD{{ budget.daily_limit }}</p>
    <p>
      <strong>Duration:</strong> {{ budget.start_date }} â†’ {{ budget.end_date }}
    </p>

    <p>
      <strong>Status:</strong>
      {% if budget.end_date < today %}
      <span style="color: red">Expired</span>
      {% else %}
      <span style="color: green">Active</span>
      {% endif %}
    </p>

    <div style="margin-top: 1rem">
      <a
        href="{% url 'budget_detail' budget.id %}"
        class="btn teal white-text"
        style="margin-right: 5px"
        >View Details</a
      >
      <a
        href="{% url 'budget_update' budget.id %}"
        class="btn orange white-text"
        style="margin-right: 5px"
        >Edit</a
      >
      <a href="{% url 'budget_delete' budget.id %}" class="btn red white-text"
        >Delete</a
      >
      <a href="{% url 'expense_create' %}?budget_id={{ budget.id }}" class="btn btn-small teal">Add Expense</a>
    </div>
  </div>
  {% empty %}
  <p>No budgets created yet.</p>
  {% endfor %}
</div>
{% endblock %}
